select substr(subsidiary.name,1,4) subsidiary, custentity_rsc_term_cl_suspensiva inicioApropriacao,  round(((( (select sum(amount)  valor from (select sum(case when transactionaccountingline.credit > 0 then (transactionaccountingline.credit*-1) else transactionaccountingline.debit end )  amount, account.acctnumber, BUILTIN.DF(transaction.postingperiod), transactionline.subsidiary, transaction.postingperiod from transactionaccountingline, transaction, transactionline, account where transaction.id = transactionaccountingline.transaction and transaction.id = transactionline.transaction and transactionLine.id = TransactionAccountingLine.transactionline
and transactionLine.transaction = TransactionAccountingLine.transaction and account.id = transactionaccountingline.account /* and transactionline.mainline = 'T' */ and (transactionline.custcol_rsc_neutralizacaoreceita = 'F' or transactionline.custcol_rsc_neutralizacaoreceita is null) and transaction.recordtype in ('journalentry', 'vendorbill') and transaction.custbody_rsc_projeto_obra_gasto_compra = job.id 
group by account.acctnumber, BUILTIN.DF(transaction.postingperiod), transactionline.subsidiary, transaction.postingperiod) transacao where  subsidiary =  subsidiary.id AND  postingperiod <=  161 and acctnumber in ('2811010100','2811010200','2811020100','2811030100','2811030200','2811040100','2811050100','2812060100','2812060110','2811070100','2811070300','2811090100','2811090300','2812010100','2812010200','2812010300','2812010400','2812010500','2812020100','2812030100','2812030200','2812030300','2812040100') ) + (select sum(amount)  valor from (select sum(case when transactionaccountingline.credit > 0 then (transactionaccountingline.credit*-1) else transactionaccountingline.debit end )  amount, account.acctnumber, BUILTIN.DF(transaction.postingperiod), transactionline.subsidiary, transaction.postingperiod from transactionaccountingline, transaction, transactionline, account where transaction.id = transactionaccountingline.transaction and transaction.id = transactionline.transaction and transactionLine.id = TransactionAccountingLine.transactionline
and transactionLine.transaction = TransactionAccountingLine.transaction and account.id = transactionaccountingline.account /* and transactionline.mainline = 'T' */ and (transactionline.custcol_rsc_neutralizacaoreceita = 'F' or transactionline.custcol_rsc_neutralizacaoreceita is null) and transaction.recordtype in ('journalentry', 'vendorbill') and transaction.custbody_rsc_projeto_obra_gasto_compra = job.id 
group by account.acctnumber, BUILTIN.DF(transaction.postingperiod), transactionline.subsidiary, transaction.postingperiod) transacao where  subsidiary =  subsidiary.id AND  postingperiod <=  161 and acctnumber in ('2812050100','2812070100','2812080100','2813010100','2813010200','2813020300','2813028888','2813030100','2813040100','2813040200','2813040300','2813050100','2813060100','2813060200','2813060300') )) * 1)), 2)ajustecfcreforiginal_29011_27827_65_F_F_F_F , round(((( (select sum(amount)  valor from (select sum(case when transactionaccountingline.credit > 0 then (transactionaccountingline.credit*-1) else transactionaccountingline.debit end )  amount, account.acctnumber, BUILTIN.DF(transaction.postingperiod), transactionline.subsidiary, transaction.postingperiod from transactionaccountingline, transaction, transactionline, account where transaction.id = transactionaccountingline.transaction and transaction.id = transactionline.transaction and transactionLine.id = TransactionAccountingLine.transactionline
and transactionLine.transaction = TransactionAccountingLine.transaction and account.id = transactionaccountingline.account /* and transactionline.mainline = 'T' */ and (transactionline.custcol_rsc_neutralizacaoreceita = 'F' or transactionline.custcol_rsc_neutralizacaoreceita is null) and transaction.recordtype in ('journalentry', 'vendorbill') and transaction.custbody_rsc_projeto_obra_gasto_compra = job.id 
group by account.acctnumber, BUILTIN.DF(transaction.postingperiod), transactionline.subsidiary, transaction.postingperiod) transacao where  subsidiary =  subsidiary.id AND  postingperiod <=  161 and acctnumber in ('2811040100') ) + (select sum(amount)  *-1  valor from (select sum(case when transactionaccountingline.credit > 0 then (transactionaccountingline.credit*-1) else transactionaccountingline.debit end )  amount, account.acctnumber, BUILTIN.DF(transaction.postingperiod), transactionline.subsidiary, transaction.postingperiod from transactionaccountingline, transaction, transactionline, account where transaction.id = transactionaccountingline.transaction and transaction.id = transactionline.transaction and transactionLine.id = TransactionAccountingLine.transactionline
and transactionLine.transaction = TransactionAccountingLine.transaction and account.id = transactionaccountingline.account /* and transactionline.mainline = 'T' */ and (transactionline.custcol_rsc_neutralizacaoreceita = 'F' or transactionline.custcol_rsc_neutralizacaoreceita is null) and transaction.recordtype in ('journalentry', 'vendorbill') and transaction.custbody_rsc_projeto_obra_gasto_compra = job.id 
group by account.acctnumber, BUILTIN.DF(transaction.postingperiod), transactionline.subsidiary, transaction.postingperiod) transacao where  subsidiary =  subsidiary.id AND  postingperiod <=  161 and acctnumber in ('2811050100') )) * 1)), 2)adiantClienteCFC_27825_28734_77_F_F_T_F , round(((( (select sum(amount)  valor from (select sum(case when transactionaccountingline.credit > 0 then (transactionaccountingline.credit*-1) else transactionaccountingline.debit end )  amount, account.acctnumber, BUILTIN.DF(transaction.postingperiod), transactionline.subsidiary, transaction.postingperiod from transactionaccountingline, transaction, transactionline, account where transaction.id = transactionaccountingline.transaction and transaction.id = transactionline.transaction and transactionLine.id = TransactionAccountingLine.transactionline
and transactionLine.transaction = TransactionAccountingLine.transaction and account.id = transactionaccountingline.account /* and transactionline.mainline = 'T' */ and (transactionline.custcol_rsc_neutralizacaoreceita = 'F' or transactionline.custcol_rsc_neutralizacaoreceita is null) and transaction.recordtype in ('journalentry', 'vendorbill') and transaction.custbody_rsc_projeto_obra_gasto_compra = job.id 
group by account.acctnumber, BUILTIN.DF(transaction.postingperiod), transactionline.subsidiary, transaction.postingperiod) transacao where  subsidiary =  subsidiary.id AND  postingperiod <=  161 and acctnumber in ('2241010200','2241010100','2241010300','2241010400','2241010500','2241019999','2242010100') )) * 1)), 2)ajustecfcobrigacaooriginal_28429_27827_68_F_F_F_T ,  from subsidiary, job
where subsidiary.custrecordtpemp in (1,2) and job.custentity_rsc_aprop_subsidiaria = subsidiary.id and subsidiary.id in (241, 179, 247) order by 1